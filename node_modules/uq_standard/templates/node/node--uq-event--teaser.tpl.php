<?php

/**
 * @file
 * Template for teaser viewmode of uq_event content type.
 */
$current_date = strtotime("now");
?>
<?php if (!empty($content)): ?>
<div class="event--teaser">
  <div class="row event__wrapper">
    <div class="event <?php if (!empty($content['field_uq_event_teaser_image'])):
      print 'event--has-image';
    endif; ?>">
      <?php if (!empty($content['field_uq_event_teaser_image'])): ?>
      <div class="column small-5 medium-3 event__media">
        <div class="event__teaser-image">
          <?php print render($content['field_uq_event_teaser_image']); ?>
        </div>
      </div>
      <div class="column small-7 medium-9 event__content">
        <?php else: ?>
        <div class="column small-12 event__content">
          <?php
          endif; ?>
          <h3 class="event__title">
            <a href="<?php print render($variables['node_url']); ?>">
              <?php print render($variables['title']); ?>
            </a>
          </h3>
          <div class="row collapse">
            <div class="column small-12 medium-9">
              <?php if (!empty($content['field_uq_event_type'])): ?>
                <div class="event__type">
                  <?php print render($content['field_uq_event_type']); ?>
                </div>
                <?php
              endif; ?>

              <?php if (!empty($content['field_uq_event_summary'])): ?>
                <div class="event__summary">
                  <?php print render($content['field_uq_event_summary']); ?>
                </div>
                <?php
              endif; ?>
            </div>
            <div class="column small-12 medium-3">
              <?php if (!empty($content['field_uq_event_reg_url'])): ?>
                <?php
                if (!empty($content['field_uq_event_reg_date'])) {
                  $reg_value = render($content['field_uq_event_reg_date']);
                  $reg_array = explode(" to ", $reg_value);
                  if (isset($reg_array[1]) && $reg_array[0] != $reg_array[1]) {
                    $reg_date = strtotime($reg_array[1]);
                  } else {
                    $reg_date = strtotime($reg_array[0]);
                  }
                }
                ?>
                <?php if (empty($content['field_uq_event_reg_date']) || $reg_date > $current_date) : ?>
                  <div class="event__register-link">
                    <?php print render($content['field_uq_event_reg_url']); ?>
                  </div>
                  <?php
                endif; ?>
                <?php
              endif; ?>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <?php
  endif; ?>
