<?php

/**
 * @file
 * Default theme implementation to display an iCal calendar.
 *
 * Available variables:
 * - $title: The name of the calendar.
 * - $rows: An array of events.
 *
 * If you are editing this file, remember that all output lines generated by it
 * must end with DOS-style \r\n line endings, and not Unix-style \n, in order to
 * be compliant with the iCal spec.
 *
 * @see http://tools.ietf.org/html/rfc5545#section-3.1
 * @see date-vevent.tpl.php
 * @see date-valarm.tpl.php
 *
 * @ingroup themeable
 */
if (empty($method)):
  $method = 'PUBLISH';
endif;
print "BEGIN:VCALENDAR\r\n";
print "VERSION:2.0\r\n";
print "CALSCALE:GREGORIAN\r\n";
print "BEGIN:VTIMEZONE\r\n";
print "TZID:Australia/Brisbane\r\n";
print "BEGIN:DAYLIGHT\r\n";
print "TZOFFSETFROM:+1000\r\n";
print "RRULE:FREQ=YEARLY;UNTIL=19911026T160000Z;BYMONTH=10;BYDAY=-1SU\r\n";
print "DTSTART:19891029T02000\r\n";
print "TZNAME:AEDT\r\n";
print "TZOFFSETTO:+1100\r\n";
print "END:DAYLIGHT\r\n";
print "BEGIN:STANDARD\r\n";
print "TZOFFSETFROM:+1100\r\n";
print "DTSTART:19920301T030000\r\n";
print "TZNAME:AEST\r\n";
print "TZOFFSETTO:+1000\r\n";
print "END:STANDARD\r\n";
print "END:VTIMEZONE\r\n";
print "METHOD:$method\r\n";
print "PRODID:-//Drupal iCal API//EN\r\n";
// Note that theme('date_vevent') already has the right line endings.
foreach($rows as $row):
  print $row;
endforeach;
print "END:VCALENDAR\r\n";
